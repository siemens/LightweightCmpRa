<Configuration xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../../../../../../../../schemes/Configuration.xsd">
	<RaConfiguration>
		<!--Imprinting and bootstrapping with signature-based protection-->
		<Upstream>
			<CmpCredentials>
				<in>
					<SignatureBased TrustStorePath="credentials/CMP_CA_Root.pem"/>
				</in>
				<out>
					<SignatureBased KeyStorePassword="Password" KeyStorePath="credentials/CMP_LRA_UPSTREAM_Keystore.p12"/>
				</out>
			</CmpCredentials>
			<CmpHttpClient ServerUrl="http://localhost:7000/ca"/>
		</Upstream>
		<EnrollmentCredentials TrustStorePath="credentials/ENROLL_Root.pem"/>
		<Downstream AcceptRaVerified="false">
			<CmpHttpServer ServingUrl="http://localhost:6000/onlinelra"/>
			<CmpCredentials>
				<in>
					<SignatureBased TrustStorePath="credentials/CMP_EE_Root.pem"/>
				</in>
				<out>
					<SignatureBased KeyStorePassword="Password" KeyStorePath="credentials/CMP_LRA_DOWNSTREAM_Keystore.p12"/>
				</out>
			</CmpCredentials>
		</Downstream>
	</RaConfiguration>
	<RaConfiguration>
		<!--Imprinting and bootstrapping with password-based MAC protection-->
		<Upstream>
			<CmpCredentials>
				<in>
					<SignatureBased TrustStorePath="credentials/CMP_CA_Root.pem"/>
				</in>
				<out>
					<SignatureBased KeyStorePassword="Password" KeyStorePath="credentials/CMP_LRA_UPSTREAM_Keystore.p12"/>
				</out>
			</CmpCredentials>
			<CmpHttpClient ServerUrl="http://localhost:7000/ca"/>
		</Upstream>
		<EnrollmentCredentials TrustStorePath="credentials/ENROLL_Root.pem"/>
		<Downstream AcceptRaVerified="false">
			<CmpHttpServer ServingUrl="http://localhost:6002/lrawithmacprotection"/>
			<CmpCredentials>
				<in>
					<PasswordBased Password="myPresharedSecret" Username="keyIdentification"/>
				</in>
				<out>
					<PasswordBased Password="myPresharedSecret" Username="keyIdentification"/>
				</out>
			</CmpCredentials>
		</Downstream>
	</RaConfiguration>
	<RaConfiguration>
		<Upstream>
			<!--Key update and revocation with signature-based protection using cert to be udpated/revoked-->
			<CmpCredentials>
				<in>
					<SignatureBased TrustStorePath="credentials/CMP_CA_Root.pem"/>
				</in>
				<out>
					<SignatureBased KeyStorePassword="Password" KeyStorePath="credentials/CMP_LRA_UPSTREAM_Keystore.p12"/>
				</out>
			</CmpCredentials>
			<CmpHttpClient ServerUrl="http://localhost:7000/ca"/>
		</Upstream>
		<EnrollmentCredentials TrustStorePath="credentials/ENROLL_Root.pem"/>
		<Downstream AcceptRaVerified="false">
			<CmpHttpServer ServingUrl="http://localhost:6001/rrkur"/>
			<CmpCredentials>
				<in>
					<SignatureBased TrustStorePath="credentials/ENROLL_Root.pem"/> <!-- not allowed according to profile: credentials/CMP_EE_Root.pem -->
					<!-- not allowed according to profile: <PasswordBased Password="myPresharedSecret" Username="keyIdentification"/> -->
				</in>
				<out>
					<SignatureBased KeyStorePassword="Password" KeyStorePath="credentials/CMP_LRA_DOWNSTREAM_Keystore.p12"/>
					<!-- would take precedence:<PasswordBased Password="myPresharedSecret" Username="keyIdentification"/> -->
				</out>
			</CmpCredentials>
		</Downstream>
	</RaConfiguration>
	<RaConfiguration>
		<!-- Delayed Enrollment: Upper RA close to CA-->
		<Upstream>
			<CmpCredentials>
				<in>
					<SignatureBased TrustStorePath="credentials/CMP_CA_Root.pem"/>
				</in>
				<out>
					<SignatureBased KeyStorePassword="Password" KeyStorePath="credentials/CMP_LRA_UPSTREAM_Keystore.p12"/>
				</out>
			</CmpCredentials>
			<CmpHttpClient ServerUrl="http://localhost:7000/ca"/>
		</Upstream>
		<EnrollmentCredentials TrustStorePath="credentials/ENROLL_Root.pem"/>
		<Downstream AcceptRaVerified="false">
			<OfflineFileServer OutputDirectory="./Downstream" InputDirectory="./Upstream"/>
			<CmpCredentials>
				<in>
					<SignatureBased TrustStorePassword="Password" TrustStorePath="credentials/CMP_LRA_UPSTREAM_Keystore.p12"/>
				</in>
				<out reprotectMode="reprotect">
					<SignatureBased KeyStorePassword="Password" KeyStorePath="credentials/CMP_LRA_UPSTREAM_Keystore.p12"/>
				</out>
			</CmpCredentials>
		</Downstream>
	</RaConfiguration>
	<RaConfiguration>
		<!-- Delayed Enrollment: Lower RA close to EE-->
		<Upstream>
			<CmpCredentials>
				<in>
					<SignatureBased TrustStorePassword="Password" TrustStorePath="credentials/CMP_LRA_UPSTREAM_Keystore.p12"/>
				</in>
				<out>
					<SignatureBased KeyStorePassword="Password" KeyStorePath="credentials/CMP_LRA_UPSTREAM_Keystore.p12"/>
				</out>
			</CmpCredentials>
			<OfflineFileClient OutputDirectory="./Upstream" InputDirectory="./Downstream" checkAfterTime="10"/>
		</Upstream>
		<EnrollmentCredentials TrustStorePath="credentials/ENROLL_Root.pem"/>
		<Downstream AcceptRaVerified="false">
			<CmpHttpServer ServingUrl="http://localhost:6003/delayedlra"/>
			<CmpCredentials>
				<in>
					<SignatureBased TrustStorePath="credentials/CMP_EE_Root.pem"/>
				</in>
				<out>
					<SignatureBased KeyStorePassword="Password" KeyStorePath="credentials/CMP_LRA_DOWNSTREAM_Keystore.p12"/>
				</out>
			</CmpCredentials>
		</Downstream>
	</RaConfiguration>
</Configuration>
